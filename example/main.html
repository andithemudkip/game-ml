<!DOCTYPE gml>
<qgml
    width = 300
    height = 300
>
    <var score = 0/>
    <class
        name = "ground"
        state = ({
            position: {
                x: 0,
                y: 0
            },
            size: {
                width: 50,
                height: 20
            }
        })
    />
    <world id = "world-1" default>
        <var score = 0/>
        <var
            playerWidth = 24
            playerHeight = 24
            playerPos = {
                x: 10,
                y: 50
            }
            shouldRun = false
            name = "andi"
        />
        <group
            id = "player"
            state = ({
                position: playerPos
            })
        >
            <actor
                id = "player-body"
                state = ({
                    position: { x: 0, y: 0 },
                    size: {
                        width: playerWidth,
                        height: playerHeight
                    },
                    color: 'rgba(0,0,0,0)'
                })
                
                animator = ({
                    spritesheets: {
                        idle: {
                            frames: ['./assets/frames/adventurer-idle-00.png',
                                    './assets/frames/adventurer-idle-01.png',
                                    './assets/frames/adventurer-idle-02.png',
                                    './assets/frames/adventurer-idle-03.png'],
                            frameTime: 10
                        },
                        run: {
                            strip: './assets/noBKG_KnightRun_strip.png',
                            frames: 8,
                            frameTime: 5
                        }
                    }
                })
            />
        </group>

        <!-- <var
            follower = ({
                    color: 'green',
                    size: {
                        width: 10,
                        height: 10
                    },
                    position: {
                        x: 0,
                        y: 0
                    }
                })
        />

        <actor
            id = "follower"
            state = follower
        />

        <script update>
            follower.position.x += (playerPos.x + playerWidth / 2 - 5 - follower.position.x) / 20;
            follower.position.y += (playerPos.y + playerWidth / 2 - 5 - follower.position.y) / 20;
        </script> -->

        <text state = ({ position: { x: 10, y: 70 } })>
            your position is: ${playerPos.x}, ${playerPos.y}
        </text>

        <keymapper
            w|down = (() => {
                playerPos.y -= 3;
                getActor ('player-body').animator.set ('run');
            })

            a|down = (() => {
                playerPos.x -= 3;
                getActor ('player-body').animator.set ('run');
                getActor ('player-body').direction.set ('horizontal', 'left')
            })
            
            d|down = (() => {
                playerPos.x += 3;
                getActor ('player-body').animator.set ('run');
                getActor ('player-body').direction.set ('horizontal', 'right');
            })
            
            s|down = (() => {
                playerPos.y += 3;
                getActor ('player-body').animator.set ('run');
            })

            [w,a,s,d]|up = (() => {
                getActor ('player-body').animator.set ('idle');
            })
        />
    </world>
    <var score2 = 0/>
    <world id = "world-2">
        <group id = "player">
            <actor
                id = "player-body"
            />
            <group id = "nested" >
                <actor/>
            </group>
        </group>
    </world>
</qgml>