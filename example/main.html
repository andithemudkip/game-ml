<!DOCTYPE gml>
<gml
    width = 300
    height = 300
>
    <var score = 0/>
    <class
        name = "ground"
        state = ({
            position: {
                x: 0,
                y: 0
            },
            size: {
                width: 50,
                height: 20
            }
        })
    />
    <world id = "world-1" default>
        <var score = 0/>
        <var
            playerWidth = 20
            playerPos = ({
                x: 10,
                y: 50
            })
            shouldRun = false
            name = "andi"
        />
        <group
            class = "player"
            id = "player"
            state = ({
                position: playerPos
            })
        >
            <actor
                id = "player-body"
                state = ({
                    position: { x: 0, y: 0 },
                    size: {
                        width: playerWidth,
                        height: 20
                    },
                    color: 'red'
                })
            />
        </group>

        <var
            follower = ({
                    color: 'green',
                    size: {
                        width: 10,
                        height: 10
                    },
                    position: {
                        x: 0,
                        y: 0
                    }
                })
        />

        <actor
            id = "follower"
            state = follower
        />


        

        <text state = ({ position: { x: 10, y: 70 } })>
            hello there ${name}
            your position is: ${playerPos.x}, ${playerPos.y}
        </text>




        <script update>
            follower.position.x += (playerPos.x + playerWidth / 2 - 5 - follower.position.x) / 20;
            follower.position.y += (playerPos.y + playerWidth / 2 - 5 - follower.position.y) / 20;
        </script>

        <keymapper
            w|down = (() => {
                if (shouldRun) {
                    playerPos.y -= 3;
                } else {
                    playerPos.y --;
                }
            })

            a|down = (() => {
                if (shouldRun) {
                    playerPos.x -= 3;
                } else {
                    playerPos.x --;
                }
            })

            d|down = (() => {
                if (shouldRun) {
                    playerPos.x += 3;
                } else {
                    playerPos.x ++;
                }
            })
            
            s|down = (() => {
                if (shouldRun) {
                    playerPos.y += 3;
                } else {
                    playerPos.y ++;
                }
            })

            shift|pressed = (() => {
                shouldRun = true;
            })

            shift|released = (() => {
                shouldRun = false;
            })

        />
    </world>
    <var score2 = 0/>
    <world id = "world-2">
        <group name = "another-player" class = "player">
            <actor
                id = "player-body"
            />
            <actor
                id = "sword"
            />
            <group name = "nested-again" >
                <group>
                    <group>

                    </group>
                </group>
            </group>
        </group>    
    </world>
</gml>